Audited 188 packages in 122ms
2026-01-18 14:40:31,445 [INFO] __main__: ğŸš€ Starting SAE Training
2026-01-18 14:40:31,446 [INFO] __main__: ğŸ“± Using device: cuda
2026-01-18 14:40:31,446 [INFO] __main__: ğŸ”§ Model: speakleash/Bielik-4.5B-v3.0-Instruct
2026-01-18 14:40:31,446 [INFO] __main__: ğŸ“ Store directory: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store
2026-01-18 14:40:31,602 [INFO] __main__: ğŸ”Œ CUDA available: NVIDIA H100 PCIe
2026-01-18 14:40:31,602 [INFO] __main__: ğŸ’¾ CUDA memory: 85.03 GB
2026-01-18 14:40:31,602 [INFO] __main__: ğŸ“¥ Loading language model...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [01:57<01:57, 117.80s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [03:49<00:00, 114.21s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [03:49<00:00, 114.75s/it]
2026-01-18 14:44:28,089 [INFO] __main__: âœ… Model loaded: speakleash_Bielik-4.5B-v3.0-Instruct
2026-01-18 14:44:28,090 [INFO] __main__: ğŸ“ Using run ID from command line: activations_20260118_122829
2026-01-18 14:44:28,090 [INFO] __main__: ğŸ“ Using run ID: activations_20260118_122829
2026-01-18 14:44:28,357 [INFO] __main__: ğŸ“¦ Found 1123 batches
2026-01-18 14:44:28,360 [INFO] __main__: ğŸ¯ Using layer index 1: llamaforcausallm_model_layers_38
2026-01-18 14:44:28,394 [INFO] __main__: ğŸ“Š Activation dimension: 2048
2026-01-18 14:44:28,394 [INFO] __main__: ğŸ“Š SAE latents: 8192 (4x overcomplete)
2026-01-18 14:44:28,394 [INFO] __main__: ğŸ“Š TopK: 64
2026-01-18 14:44:28,394 [INFO] __main__: ğŸ—ï¸  Creating TopKSAE...
2026-01-18 14:44:28,831 [INFO] __main__: âœ… SAE created: 2048 -> 8192 (TopK=64)
2026-01-18 14:44:28,832 [INFO] __main__: ğŸ‹ï¸ Training TopKSAE...
2026-01-18 14:44:28,832 [INFO] __main__:    Epochs: 25
2026-01-18 14:44:28,832 [INFO] __main__:    Batch size: 64
2026-01-18 14:44:28,832 [INFO] __main__:    Learning rate: 0.001
2026-01-18 14:44:28,832 [INFO] __main__:    L1 lambda: 0.0001
2026-01-18 14:44:28,832 [INFO] __main__:    Device: cuda
2026-01-18 14:44:28,832 [INFO] __main__:    Dtype: None
2026-01-18 14:44:28,832 [INFO] __main__:    Monitoring: detailed (level 2)
2026-01-18 14:44:28,832 [INFO] __main__:    Memory efficient: True
2026-01-18 14:44:28,832 [INFO] __main__:    Snapshots: every 5 epochs
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb: enabled
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb project: amber_playground
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb entity: amber_team
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb mode: online
2026-01-18 14:44:34,806 [WARNING] __main__: âš ï¸  Invalid WANDB_API_KEY length: expected 40 characters, got 86
2026-01-18 14:44:34,807 [WARNING] __main__:    Wandb will run in offline mode or use existing credentials
2026-01-18 14:44:34,807 [INFO] __main__: ğŸ“¦ Checking dataloader...
2026-01-18 14:44:34,807 [INFO] __main__:    Testing dataloader with 1 batch...
2026-01-18 14:44:34,872 [INFO] __main__:    âœ… Dataloader works! Batch shape: torch.Size([64, 2048])
2026-01-18 14:44:34,873 [INFO] __main__: ğŸš€ Starting training (this may take a while)...
2026-01-18 14:44:34,873 [INFO] mi_crow.mechanistic.sae.modules.topk_sae: Initializing SAE engine with k=64
wandb: Appending key for api.wandb.ai to your netrc file: /home2/faculty/akaniasty/.netrc
wandb: Currently logged in as: adam-kaniasty (amber_team) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run pll0zk8x
wandb: Tracking run with wandb version 0.23.1
wandb: Run data is saved locally in /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/wandb/run-20260118_144437-pll0zk8x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run activations_20260118_122829
wandb: â­ï¸ View project at https://wandb.ai/amber_team/amber_playground
wandb: ğŸš€ View run at https://wandb.ai/amber_team/amber_playground/runs/pll0zk8x
2026-01-18 14:44:42,769 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb run initialized: activations_20260118_122829 (id: pll0zk8x)
2026-01-18 14:44:42,770 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb project: amber_playground, entity: amber_team
2026-01-18 14:44:42,778 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Starting training run_id=activations_20260118_122829 epochs=25 batch_size=64 device=cuda use_amp=True
2026-01-18 14:44:42,779 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Running training with snapshots every 5 epochs
2026-01-18 14:44:42,779 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 1/25
2026-01-18 15:08:09,855 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 2/25
2026-01-18 15:29:44,168 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 3/25
2026-01-18 15:51:23,877 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 4/25
2026-01-18 16:12:46,937 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 5/25
2026-01-18 16:34:19,802 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/snapshots/model_epoch_5.pt
2026-01-18 16:34:20,343 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 6/25
2026-01-18 16:55:52,902 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 7/25
2026-01-18 17:17:22,289 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 8/25
2026-01-18 17:38:44,368 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 9/25
2026-01-18 18:00:02,657 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 10/25
2026-01-18 18:21:23,750 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/snapshots/model_epoch_10.pt
2026-01-18 18:21:24,606 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 11/25
2026-01-18 18:42:50,489 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 12/25
2026-01-18 19:04:18,525 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 13/25
2026-01-18 19:25:56,803 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 14/25
2026-01-18 19:47:29,625 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 15/25
2026-01-18 20:08:46,651 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/snapshots/model_epoch_15.pt
2026-01-18 20:08:47,789 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 16/25
2026-01-18 20:30:07,835 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 17/25
2026-01-18 20:51:19,985 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 18/25
2026-01-18 21:12:42,554 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 19/25
2026-01-18 21:34:06,862 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 20/25
2026-01-18 21:55:31,599 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/snapshots/model_epoch_20.pt
2026-01-18 21:55:32,970 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 21/25
2026-01-18 22:16:48,638 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 22/25
2026-01-18 22:37:57,460 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 23/25
2026-01-18 22:59:08,449 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 24/25
2026-01-18 23:20:18,868 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 25/25
2026-01-18 23:41:25,221 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/snapshots/model_epoch_25.pt
2026-01-18 23:41:26,716 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training with snapshots completed, processing 25 epoch results...
2026-01-18 23:41:26,726 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 1: loss=0.795796 recon_mse=0.019016 l1=9.169803 r2=0.980984
2026-01-18 23:41:26,726 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 2: loss=0.238203 recon_mse=0.017738 l1=8.043651 r2=0.982262
2026-01-18 23:41:26,726 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 3: loss=0.215859 recon_mse=0.017693 l1=8.075432 r2=0.982307
2026-01-18 23:41:26,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 4: loss=0.209855 recon_mse=0.017706 l1=8.002938 r2=0.982294
2026-01-18 23:41:26,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 5: loss=0.208817 recon_mse=0.017694 l1=7.994686 r2=0.982306
2026-01-18 23:41:26,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 6: loss=0.207953 recon_mse=0.017662 l1=8.120402 r2=0.982338
2026-01-18 23:41:26,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 7: loss=0.210405 recon_mse=0.017684 l1=8.034490 r2=0.982316
2026-01-18 23:41:26,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 8: loss=0.209835 recon_mse=0.017710 l1=8.061783 r2=0.982290
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 9: loss=0.209299 recon_mse=0.017682 l1=8.198923 r2=0.982318
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 10: loss=0.210655 recon_mse=0.017734 l1=8.180018 r2=0.982266
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 11: loss=0.216645 recon_mse=0.017721 l1=8.204231 r2=0.982279
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 12: loss=0.216715 recon_mse=0.017767 l1=8.074621 r2=0.982233
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 13: loss=0.213230 recon_mse=0.017693 l1=8.065696 r2=0.982307
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 14: loss=0.211180 recon_mse=0.017710 l1=7.985830 r2=0.982290
2026-01-18 23:41:26,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 15: loss=0.211788 recon_mse=0.017716 l1=7.891814 r2=0.982284
2026-01-18 23:41:26,729 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 16: loss=0.210650 recon_mse=0.017713 l1=7.975126 r2=0.982287
2026-01-18 23:41:26,729 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 17: loss=0.210569 recon_mse=0.017713 l1=8.000760 r2=0.982287
2026-01-18 23:41:26,729 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 18: loss=0.209766 recon_mse=0.017702 l1=8.027202 r2=0.982298
2026-01-18 23:41:26,729 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 19: loss=0.210505 recon_mse=0.017675 l1=8.077710 r2=0.982325
2026-01-18 23:41:26,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 20: loss=0.213753 recon_mse=0.017759 l1=8.046093 r2=0.982241
2026-01-18 23:41:26,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 21: loss=0.210830 recon_mse=0.017877 l1=7.800065 r2=0.982123
2026-01-18 23:41:26,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 22: loss=0.209233 recon_mse=0.017896 l1=7.717197 r2=0.982104
2026-01-18 23:41:26,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 23: loss=0.211684 recon_mse=0.017928 l1=7.662239 r2=0.982072
2026-01-18 23:41:26,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 24: loss=0.209542 recon_mse=0.017976 l1=7.651224 r2=0.982024
2026-01-18 23:41:26,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 25: loss=0.208808 recon_mse=0.018007 l1=7.591058 r2=0.981993
2026-01-18 23:41:27,571 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging metrics to wandb (history keys: ['loss', 'recon_mse', 'l1', 'r2', 'l0', 'dead_features_pct'], num epochs: 25)
2026-01-18 23:41:27,571 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging 25 epochs to wandb
2026-01-18 23:41:27,572 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 1 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,574 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 2 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,575 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 3 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,576 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 4 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,577 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 5 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,578 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 6 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,578 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 7 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,579 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 8 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,579 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 9 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,580 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 10 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,581 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 11 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,582 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 12 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,582 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 13 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,583 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 14 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,583 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 15 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,584 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 16 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,584 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 17 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,585 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 18 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,585 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 19 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,586 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 20 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,586 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 21 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,587 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 22 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,588 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 23 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,588 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 24 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:41:27,589 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 25 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate', 'train/l0_sparsity', 'train/dead_features_pct']
2026-01-18 23:41:27,590 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Updated wandb summary with final metrics: ['final/loss', 'final/reconstruction_mse', 'final/r2_score', 'final/l1_penalty', 'final/l0_sparsity', 'final/dead_features_pct', 'training/num_epochs', 'best/loss', 'best/loss_epoch', 'best/r2_score', 'best/r2_epoch']
2026-01-18 23:41:27,591 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Metrics logged to wandb: https://wandb.ai/amber_team/amber_playground/runs/pll0zk8x
2026-01-18 23:41:27,591 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb run URL: https://wandb.ai/amber_team/amber_playground/runs/pll0zk8x
wandb: updating run metadata
wandb: uploading wandb-summary.json; uploading output.log
wandb: uploading history steps 0-24, summary, console lines 58-114
wandb: 
wandb: Run history:
wandb:                    epoch â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆ
wandb:  train/dead_features_pct â–
wandb:        train/l0_sparsity â–
wandb:         train/l1_penalty â–ˆâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–â–â–
wandb:      train/learning_rate â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:               train/loss â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:           train/r2_score â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–†â–†
wandb: train/reconstruction_mse â–ˆâ–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–ƒâ–ƒ
wandb: 
wandb: Run summary:
wandb:               best/loss 0.20795
wandb:         best/loss_epoch 6
wandb:           best/r2_epoch 6
wandb:           best/r2_score 0.98234
wandb:                   epoch 25
wandb: final/dead_features_pct 0.63135
wandb:       final/l0_sparsity 0
wandb:        final/l1_penalty 7.59106
wandb:              final/loss 0.20881
wandb:          final/r2_score 0.98199
wandb:                      +9 ...
wandb: 
wandb: ğŸš€ View run activations_20260118_122829 at: https://wandb.ai/amber_team/amber_playground/runs/pll0zk8x
wandb: â­ï¸ View project at: https://wandb.ai/amber_team/amber_playground
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20260118_144437-pll0zk8x/logs
2026-01-18 23:41:28,679 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb run finished and synced
2026-01-18 23:41:28,680 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training completed, processing 25 epochs of results
2026-01-18 23:41:28,680 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Completed training
2026-01-18 23:41:28,680 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saving training outputs to store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/
2026-01-18 23:41:29,103 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved model to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/model.pt
2026-01-18 23:41:29,103 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved history to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/history.json
2026-01-18 23:41:29,103 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved metadata to: runs/sae_llamaforcausallm_model_layers_38_20260118_144434/meta.json
2026-01-18 23:41:29,769 [INFO] __main__: âœ… Training function returned!
2026-01-18 23:41:29,770 [INFO] __main__: ğŸ’¾ Training outputs saved to: store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/
2026-01-18 23:41:29,770 [INFO] __main__:    - Model: store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/model.pt
2026-01-18 23:41:29,770 [INFO] __main__:    - History: store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/history.json
2026-01-18 23:41:29,770 [INFO] __main__:    - Metadata: store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/meta.json
2026-01-18 23:41:29,770 [INFO] __main__:    - Snapshots: store/runs/sae_llamaforcausallm_model_layers_38_20260118_144434/snapshots/
2026-01-18 23:41:29,770 [INFO] __main__:    - Wandb URL: https://wandb.ai/amber_team/amber_playground/runs/pll0zk8x
