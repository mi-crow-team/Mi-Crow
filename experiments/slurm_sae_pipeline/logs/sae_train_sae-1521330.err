Audited 188 packages in 122ms
2026-01-18 14:40:31,645 [INFO] __main__: üöÄ Starting SAE Training
2026-01-18 14:40:31,645 [INFO] __main__: üì± Using device: cuda
2026-01-18 14:40:31,646 [INFO] __main__: üîß Model: speakleash/Bielik-4.5B-v3.0-Instruct
2026-01-18 14:40:31,646 [INFO] __main__: üìÅ Store directory: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store
2026-01-18 14:40:31,679 [INFO] __main__: üîå CUDA available: NVIDIA H100 PCIe
2026-01-18 14:40:31,679 [INFO] __main__: üíæ CUDA memory: 85.03 GB
2026-01-18 14:40:31,679 [INFO] __main__: üì• Loading language model...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:57<01:57, 117.93s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [03:49<00:00, 114.12s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [03:49<00:00, 114.69s/it]
2026-01-18 14:44:28,062 [INFO] __main__: ‚úÖ Model loaded: speakleash_Bielik-4.5B-v3.0-Instruct
2026-01-18 14:44:28,062 [INFO] __main__: üìÅ Using run ID from command line: activations_20260118_122829
2026-01-18 14:44:28,062 [INFO] __main__: üìÅ Using run ID: activations_20260118_122829
2026-01-18 14:44:28,357 [INFO] __main__: üì¶ Found 1123 batches
2026-01-18 14:44:28,360 [INFO] __main__: üéØ Using layer index 0: llamaforcausallm_model_layers_28
2026-01-18 14:44:28,394 [INFO] __main__: üìä Activation dimension: 2048
2026-01-18 14:44:28,394 [INFO] __main__: üìä SAE latents: 8192 (4x overcomplete)
2026-01-18 14:44:28,394 [INFO] __main__: üìä TopK: 64
2026-01-18 14:44:28,394 [INFO] __main__: üèóÔ∏è  Creating TopKSAE...
2026-01-18 14:44:28,831 [INFO] __main__: ‚úÖ SAE created: 2048 -> 8192 (TopK=64)
2026-01-18 14:44:28,832 [INFO] __main__: üèãÔ∏è Training TopKSAE...
2026-01-18 14:44:28,832 [INFO] __main__:    Epochs: 25
2026-01-18 14:44:28,832 [INFO] __main__:    Batch size: 64
2026-01-18 14:44:28,832 [INFO] __main__:    Learning rate: 0.001
2026-01-18 14:44:28,832 [INFO] __main__:    L1 lambda: 0.0001
2026-01-18 14:44:28,832 [INFO] __main__:    Device: cuda
2026-01-18 14:44:28,832 [INFO] __main__:    Dtype: None
2026-01-18 14:44:28,832 [INFO] __main__:    Monitoring: detailed (level 2)
2026-01-18 14:44:28,832 [INFO] __main__:    Memory efficient: True
2026-01-18 14:44:28,832 [INFO] __main__:    Snapshots: every 5 epochs
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb: enabled
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb project: amber_playground
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb entity: amber_team
2026-01-18 14:44:28,832 [INFO] __main__:    Wandb mode: online
2026-01-18 14:44:34,806 [WARNING] __main__: ‚ö†Ô∏è  Invalid WANDB_API_KEY length: expected 40 characters, got 86
2026-01-18 14:44:34,806 [WARNING] __main__:    Wandb will run in offline mode or use existing credentials
2026-01-18 14:44:34,807 [INFO] __main__: üì¶ Checking dataloader...
2026-01-18 14:44:34,807 [INFO] __main__:    Testing dataloader with 1 batch...
2026-01-18 14:44:34,872 [INFO] __main__:    ‚úÖ Dataloader works! Batch shape: torch.Size([64, 2048])
2026-01-18 14:44:34,873 [INFO] __main__: üöÄ Starting training (this may take a while)...
2026-01-18 14:44:34,873 [INFO] mi_crow.mechanistic.sae.modules.topk_sae: Initializing SAE engine with k=64
wandb: Appending key for api.wandb.ai to your netrc file: /home2/faculty/akaniasty/.netrc
wandb: Currently logged in as: adam-kaniasty (amber_team) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run ewx64dw9
wandb: Tracking run with wandb version 0.23.1
wandb: Run data is saved locally in /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/wandb/run-20260118_144437-ewx64dw9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run activations_20260118_122829
wandb: ‚≠êÔ∏è View project at https://wandb.ai/amber_team/amber_playground
wandb: üöÄ View run at https://wandb.ai/amber_team/amber_playground/runs/ewx64dw9
2026-01-18 14:44:42,769 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb run initialized: activations_20260118_122829 (id: ewx64dw9)
2026-01-18 14:44:42,769 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb project: amber_playground, entity: amber_team
2026-01-18 14:44:42,778 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Starting training run_id=activations_20260118_122829 epochs=25 batch_size=64 device=cuda use_amp=True
2026-01-18 14:44:42,779 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Running training with snapshots every 5 epochs
2026-01-18 14:44:42,779 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 1/25
2026-01-18 15:08:08,472 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 2/25
2026-01-18 15:29:37,297 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 3/25
2026-01-18 15:51:15,736 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 4/25
2026-01-18 16:12:35,837 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 5/25
2026-01-18 16:34:04,450 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/snapshots/model_epoch_5.pt
2026-01-18 16:34:05,109 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 6/25
2026-01-18 16:55:33,588 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 7/25
2026-01-18 17:16:58,623 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 8/25
2026-01-18 17:38:13,282 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 9/25
2026-01-18 17:59:30,425 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 10/25
2026-01-18 18:20:46,884 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/snapshots/model_epoch_10.pt
2026-01-18 18:20:48,276 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 11/25
2026-01-18 18:42:11,816 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 12/25
2026-01-18 19:03:38,534 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 13/25
2026-01-18 19:25:15,995 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 14/25
2026-01-18 19:46:45,799 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 15/25
2026-01-18 20:07:57,626 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/snapshots/model_epoch_15.pt
2026-01-18 20:07:59,206 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 16/25
2026-01-18 20:29:11,313 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 17/25
2026-01-18 20:50:22,243 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 18/25
2026-01-18 21:11:38,244 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 19/25
2026-01-18 21:32:58,505 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 20/25
2026-01-18 21:54:20,362 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/snapshots/model_epoch_20.pt
2026-01-18 21:54:21,827 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 21/25
2026-01-18 22:15:35,467 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 22/25
2026-01-18 22:36:40,656 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 23/25
2026-01-18 22:57:48,077 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 24/25
2026-01-18 23:18:58,242 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training epoch 25/25
2026-01-18 23:40:04,202 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved snapshot to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/snapshots/model_epoch_25.pt
2026-01-18 23:40:05,857 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training with snapshots completed, processing 25 epoch results...
2026-01-18 23:40:05,868 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 1: loss=0.741426 recon_mse=0.011391 l1=8.933032 r2=0.988609
2026-01-18 23:40:05,868 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 2: loss=0.235896 recon_mse=0.010479 l1=7.273176 r2=0.989521
2026-01-18 23:40:05,868 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 3: loss=0.210152 recon_mse=0.010464 l1=7.002293 r2=0.989536
2026-01-18 23:40:05,869 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 4: loss=0.210841 recon_mse=0.010488 l1=7.047349 r2=0.989512
2026-01-18 23:40:05,869 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 5: loss=0.209618 recon_mse=0.010500 l1=7.103979 r2=0.989500
2026-01-18 23:40:05,869 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 6: loss=0.209674 recon_mse=0.010485 l1=7.208047 r2=0.989515
2026-01-18 23:40:05,869 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 7: loss=0.210446 recon_mse=0.010471 l1=7.177689 r2=0.989529
2026-01-18 23:40:05,869 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 8: loss=0.210567 recon_mse=0.010484 l1=7.245150 r2=0.989516
2026-01-18 23:40:05,870 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 9: loss=0.210019 recon_mse=0.010530 l1=6.986830 r2=0.989470
2026-01-18 23:40:05,870 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 10: loss=0.208334 recon_mse=0.010608 l1=6.896387 r2=0.989392
2026-01-18 23:40:05,870 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 11: loss=0.212712 recon_mse=0.010584 l1=6.932475 r2=0.989416
2026-01-18 23:40:05,870 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 12: loss=0.212612 recon_mse=0.010635 l1=6.846772 r2=0.989365
2026-01-18 23:40:05,870 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 13: loss=0.207388 recon_mse=0.010589 l1=6.747331 r2=0.989411
2026-01-18 23:40:05,871 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 14: loss=0.207025 recon_mse=0.010566 l1=6.732629 r2=0.989434
2026-01-18 23:40:05,871 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 15: loss=0.205791 recon_mse=0.010553 l1=6.706188 r2=0.989447
2026-01-18 23:40:05,871 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 16: loss=0.205431 recon_mse=0.010580 l1=6.708773 r2=0.989420
2026-01-18 23:40:05,871 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 17: loss=0.206566 recon_mse=0.010595 l1=6.717968 r2=0.989405
2026-01-18 23:40:05,871 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 18: loss=0.206648 recon_mse=0.010607 l1=6.747417 r2=0.989393
2026-01-18 23:40:05,871 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 19: loss=0.206749 recon_mse=0.010596 l1=6.773035 r2=0.989404
2026-01-18 23:40:05,872 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 20: loss=0.206672 recon_mse=0.010595 l1=6.775378 r2=0.989405
2026-01-18 23:40:05,872 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 21: loss=0.206967 recon_mse=0.010607 l1=6.848373 r2=0.989393
2026-01-18 23:40:05,872 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 22: loss=0.208984 recon_mse=0.010594 l1=6.819636 r2=0.989406
2026-01-18 23:40:05,872 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 23: loss=0.208616 recon_mse=0.010589 l1=6.700571 r2=0.989411
2026-01-18 23:40:05,872 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 24: loss=0.207864 recon_mse=0.010583 l1=6.745410 r2=0.989417
2026-01-18 23:40:05,873 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Epoch 25: loss=0.207445 recon_mse=0.010589 l1=6.807217 r2=0.989411
2026-01-18 23:40:06,717 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging metrics to wandb (history keys: ['loss', 'recon_mse', 'l1', 'r2', 'l0', 'dead_features_pct'], num epochs: 25)
2026-01-18 23:40:06,717 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging 25 epochs to wandb
2026-01-18 23:40:06,718 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 1 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,719 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 2 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,719 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 3 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,720 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 4 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,721 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 5 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,721 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 6 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,722 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 7 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,723 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 8 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,723 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 9 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,724 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 10 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,724 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 11 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,725 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 12 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,725 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 13 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,726 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 14 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,726 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 15 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,726 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 16 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 17 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,727 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 18 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 19 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,728 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 20 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,729 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 21 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 22 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,730 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 23 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,731 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 24 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate']
2026-01-18 23:40:06,731 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Logging epoch 25 metrics to wandb: ['epoch', 'train/loss', 'train/reconstruction_mse', 'train/r2_score', 'train/l1_penalty', 'train/learning_rate', 'train/l0_sparsity', 'train/dead_features_pct']
2026-01-18 23:40:06,733 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Updated wandb summary with final metrics: ['final/loss', 'final/reconstruction_mse', 'final/r2_score', 'final/l1_penalty', 'final/l0_sparsity', 'final/dead_features_pct', 'training/num_epochs', 'best/loss', 'best/loss_epoch', 'best/r2_score', 'best/r2_epoch']
2026-01-18 23:40:06,733 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Metrics logged to wandb: https://wandb.ai/amber_team/amber_playground/runs/ewx64dw9
2026-01-18 23:40:06,733 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb run URL: https://wandb.ai/amber_team/amber_playground/runs/ewx64dw9
wandb: uploading output.log; uploading wandb-summary.json
wandb: uploading history steps 0-24, summary, console lines 57-114
wandb: 
wandb: Run history:
wandb:                    epoch ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà
wandb:  train/dead_features_pct ‚ñÅ
wandb:        train/l0_sparsity ‚ñÅ
wandb:         train/l1_penalty ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:      train/learning_rate ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:               train/loss ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:           train/r2_score ‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb: train/reconstruction_mse ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ
wandb: 
wandb: Run summary:
wandb:               best/loss 0.20543
wandb:         best/loss_epoch 16
wandb:           best/r2_epoch 3
wandb:           best/r2_score 0.98954
wandb:                   epoch 25
wandb: final/dead_features_pct 0.73584
wandb:       final/l0_sparsity 0
wandb:        final/l1_penalty 6.80722
wandb:              final/loss 0.20744
wandb:          final/r2_score 0.98941
wandb:                      +9 ...
wandb: 
wandb: üöÄ View run activations_20260118_122829 at: https://wandb.ai/amber_team/amber_playground/runs/ewx64dw9
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/amber_team/amber_playground
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20260118_144437-ewx64dw9/logs
2026-01-18 23:40:07,837 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Wandb run finished and synced
2026-01-18 23:40:07,837 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Training completed, processing 25 epochs of results
2026-01-18 23:40:07,838 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Completed training
2026-01-18 23:40:07,838 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saving training outputs to store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/
2026-01-18 23:40:08,270 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved model to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/model.pt
2026-01-18 23:40:08,270 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved history to: /mnt/evafs/groups/mi2lab/akaniasty/Mi-Crow/experiments/slurm_sae_pipeline/store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/history.json
2026-01-18 23:40:08,270 [INFO] mi_crow.mechanistic.sae.sae_trainer: [SaeTrainer] Saved metadata to: runs/sae_llamaforcausallm_model_layers_28_20260118_144434/meta.json
2026-01-18 23:40:08,921 [INFO] __main__: ‚úÖ Training function returned!
2026-01-18 23:40:08,922 [INFO] __main__: üíæ Training outputs saved to: store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/
2026-01-18 23:40:08,922 [INFO] __main__:    - Model: store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/model.pt
2026-01-18 23:40:08,922 [INFO] __main__:    - History: store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/history.json
2026-01-18 23:40:08,922 [INFO] __main__:    - Metadata: store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/meta.json
2026-01-18 23:40:08,922 [INFO] __main__:    - Snapshots: store/runs/sae_llamaforcausallm_model_layers_28_20260118_144434/snapshots/
2026-01-18 23:40:08,922 [INFO] __main__:    - Wandb URL: https://wandb.ai/amber_team/amber_playground/runs/ewx64dw9
